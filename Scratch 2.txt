if(bIsCastling(moSelection, oEntry))
{
	if(bIsInCheck(meCurrentPlayer))
		throw exception("Castling is not allowed if you're in check");

	if(!bIsCastlingPathOk(moSelection, oEntry))
		throw exception("Your king would be in check during castling");

	poNextMove = new CastlingMove(moSelection, oEntry);
}
else if(bIsPromotion(moSelection, oEntry))
	poNextMove = new Promotion(moSelection, oEntry);
else if(moBoard.poGetPiece(moSelection)->bIsFirstMove())
	poNextMove = new FirstMove(moSelection, oEntry);
else
	poNextMove = new Movement(moSelection, oEntry);

moHistory.push_back(poNextMove);
poNextMove->Execute();

if(moBoard.poGetPiece(oEntry)->eGetType() == Piece::KING)
	moKings[moBoard.eGetSquareColor(oEntry)] = oEntry;